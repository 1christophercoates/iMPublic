<ng-container *ngIf="state$ | async as state">
  <ion-header [class.ion-no-border]="!state.loaded">
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-title>Activity Feed</ion-title>
      <ion-buttons slot="end">
        <ion-button (click)="refresh()">
          <ion-icon slot="icon-only" name="refresh"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
    <ion-progress-bar type="indeterminate" [class.hide]="state.loaded"></ion-progress-bar>
  </ion-header>

  <ion-content>
    <div class="im-cont" *ngIf="state.loaded">
      <div class="im-centered" *ngIf="state.posts.length < 1 && state.loaded">
        <div [style.display]="'grid'" [style.gap]="'0.1rem'">There are no activity posts.</div>
      </div>

      <im-block
        imageSlot="left"
        [images]="post.poi.imagesFilePaths"
        *ngFor="let post of state.posts"
      >
        <div header class="im-primary-text">{{ post.poi.enrollment.project.title }}</div>
        <div body class="timeline-details">
          <div class="timeline-detail-item">
            <ion-icon name="information-circle"></ion-icon>
            <span [ngSwitch]="post.status">
              <b [style.color]="'var(--im-poi-denied)'" *ngSwitchCase="PoiStatus.denied">Denied</b>
              <b [style.color]="'var(--im-poi-approved)'" *ngSwitchCase="PoiStatus.approved">Approved</b>
              <b [style.color]="'var(--im-poi-submitted)'" *ngSwitchCase="PoiStatus.submitted">Submitted</b>
              <b [style.color]="'var(--im-poi-stopped)'" *ngSwitchCase="PoiStatus.stopped">Stopped</b>
              <b [style.color]="'var(--im-poi-paused)'" *ngSwitchCase="PoiStatus.paused">Paused</b>
              <b [style.color]="'var(--im-poi-started)'" *ngSwitchCase="PoiStatus.started">Started</b>
              <b [style.color]="'var(--im-poi-created)'" *ngSwitchCase="PoiStatus.created">Created</b>
            </span>
          </div>
          <div class="timeline-detail-item">
            <ion-icon name="calendar"></ion-icon>
            <span *ngIf="post.poi.dateSubmitted">{{ post.poi.dateSubmitted | date: 'longDate' }}</span>
            <div *ngIf="!post.poi.dateSubmitted">No submission date.</div>
          </div>
          <div class="timeline-detail-item">
            <ion-icon name="time"></ion-icon>
            <span>{{ post.timeWorked }}</span>
          </div>
          <div class="timeline-detail-item">
            <ion-icon name="location"></ion-icon>
            <span>{{ post.poi.enrollment.project.address.city }}, {{ post.poi.enrollment.project.address.state }}</span>
          </div>
          <div class="timeline-info">{{ post.poi.enrollment.project.description }}</div>

          <div class="timeline-detail-item">
            <ion-buttons slot="start">
              <ion-button>
                <ion-icon name="heart-outline"></ion-icon>
              </ion-button>
  

              <ion-button>
                <ion-icon name="chatbubble-ellipses-outline"></ion-icon>
              </ion-button>
            </ion-buttons>
          </div>

        </div>

        
      </im-block>
      <ion-infinite-scroll threshold="100px" (ionInfinite)="loadMore($event)">
        <ion-infinite-scroll-content
          loadingSpinner="bubbles"
          loadingText="Loading more POIs..."
        ></ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </div>
  </ion-content>
</ng-container>
